{% extends "layout.html" %}
{% block content %}

<!-- FLASH MESSAGE (LOGIN, REGISTER, DLL) -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% for category, message in messages %}
    <div class="alert alert-{{ category }} text-center">
      {{ message }}
    </div>
  {% endfor %}
{% endwith %}

<!-- ALERT PEMBELIAN (DITAMBAHKAN, TIDAK MENGUBAH YANG ADA) -->
{% if beli_success %}
  <div class="alert alert-success text-center">
    {{ beli_success }}
  </div>
{% endif %}

{% if beli_error %}
  <div class="alert alert-danger text-center">
    {{ beli_error }}
  </div>
{% endif %}

<div class="container py-4">
  <div class="row">
    {% for p in produk %}
    <div class="col-md-4">
      <div class="card mb-3">
        <div class="card-body">
          <h5>{{ p.nama_produk }}</h5>
          <p>Rp {{ p.harga }}</p>
          <p>Stok: {{ p.stok }}</p>

          {% if p.stok > 0 %}
            <a href="{{ url_for('checkout', id_produk=p.id_produk) }}"
               class="btn btn-success w-100">Beli</a>
          {% else %}
            <button class="btn btn-secondary w-100" disabled>Habis</button>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

{% endblock %}
